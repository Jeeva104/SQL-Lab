CREATE TABLE Customer (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(100),
    ContactName VARCHAR(100),
    Address VARCHAR(255),
    City VARCHAR(100),
    PostalCode VARCHAR(20),
    Country VARCHAR(50)
);

table CUSTOMER created.


CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    LastName VARCHAR(100),
    FirstName VARCHAR(100),
    BirthDate DATE,
    Photo BLOB
);

table EMPLOYEES created.


CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    EmployeeID INT,
    OrderDate DATE,
    ShipperID INT,
    FOREIGN KEY (CustomerID) REFERENCES Customer(CustomerID),
    FOREIGN KEY (EmployeeID) REFERENCES Employees(EmployeeID)
);

table ORDERS created.


INSERT INTO Customer (CustomerID, CustomerName, ContactName, Address, City, PostalCode, Country) 
VALUES (1, 'John', 'John Smith', '123 Elm St', 'Springfield', '62701', 'USA');

1 rows inserted.

Insert Into Customer (CustomerID, Customername, Contactname, Address, City, Postalcode, Country) 
VALUES (2, 'Jane', 'Jane Doe', '456 Oak St', 'Metropolis', '62901', 'USA');

1 rows inserted.

Insert Into Customer (CustomerID, Customername, Contactname, Address, City, Postalcode, Country) 
VALUES (3, 'Samantha', 'Samantha Green', '505 Maple St', 'Sydney', '2000', 'Australia');

1 rows inserted.

Insert Into Customer (CustomerID, Customername, Contactname, Address, City, Postalcode, Country) 
VALUES (4, 'Liam', 'Liam Brown', '606 Pine St', 'Berlin', '10115', 'Germany');

1 rows inserted.

Insert Into Customer (CustomerID, Customername, Contactname, Address, City, Postalcode, Country) 
Values (5, 'Emma', 'Emma Davis', '707 Birch St', 'Paris', '75001', 'France');

1 rows inserted.

INSERT INTO Employees (EmployeeID, LastName, FirstName, BirthDate, Photo) VALUES (1, 'Doe', 'John', TO_DATE('1980-01-15', 'YYYY-MM-DD'), NULL);
1 rows inserted.

INSERT INTO Employees (EmployeeID, LastName, FirstName, BirthDate, Photo) VALUES (2, 'Smith', 'Alice', TO_DATE('1975-05-23', 'YYYY-MM-DD'), NULL);
1 rows inserted.

INSERT INTO Employees (EmployeeID, LastName, FirstName, BirthDate, Photo) VALUES (3, 'Johnson', 'Robert', TO_DATE('1990-07-30', 'YYYY-MM-DD'), NULL);
1 rows inserted.

INSERT INTO Employees (EmployeeID, LastName, FirstName, BirthDate, Photo) VALUES (4, 'Brown', 'Emily', TO_DATE('1985-12-10', 'YYYY-MM-DD'), NULL);
1 rows inserted.

INSERT INTO Employees (EmployeeID, LastName, FirstName, BirthDate, Photo) VALUES (5, 'Williams', 'Michael', TO_DATE('1978-03-22', 'YYYY-MM-DD'), NULL);
1 rows inserted.

INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) VALUES (1, 1, 1, TO_DATE('2024-08-15', 'YYYY-MM-DD'), 10);
1 rows inserted.

INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) VALUES (2, 2, 2, TO_DATE('2024-08-16', 'YYYY-MM-DD'), 20);
1 rows inserted.

INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) VALUES (3, 3, 3, TO_DATE('2024-08-17', 'YYYY-MM-DD'), 30);
1 rows inserted.

INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) VALUES (4, 4, 4, TO_DATE('2024-08-18', 'YYYY-MM-DD'), 40);
1 rows inserted.

INSERT INTO Orders (OrderID, CustomerID, EmployeeID, OrderDate, ShipperID) Values (5, 5, 5, To_Date('2024-08-19', 'YYYY-MM-DD'), 50);
1 rows inserted.


-- List all customers in ascending order by their names
SELECT * 
FROM Customer 
ORDER BY CustomerName ASC;
-- Output
CUSTOMERID CUSTOMERNAME                                                                                         CONTACTNAME                                                                                          ADDRESS                                                                                                                                                                                                                                                         CITY                                                                                                 POSTALCODE           COUNTRY                                          
---------- ---------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- -------------------- --------------------------------------------------
         5 Emma                                                                                                 Emma Davis                                                                                           707 Birch St                                                                                                                                                                                                                                                    Paris                                                                                                75001                France                                             
         2 Jane                                                                                                 Jane Doe                                                                                             456 Oak St                                                                                                                                                                                                                                                      Metropolis                                                                                           62901                USA                                                
         1 John                                                                                                 John Smith                                                                                           123 Elm St                                                                                                                                                                                                                                                      Springfield                                                                                          62701                USA                                                
         4 Liam                                                                                                 Liam Brown                                                                                           606 Pine St                                                                                                                                                                                                                                                     Berlin                                                                                               10115                Germany                                            
         3 Samantha                                                                                             Samantha Green                                                                                       505 Maple St                                                                                                                                                                                                                                                    Sydney                                                                                               2000                 Australia                                          

-- Retrieve a list of orders with the oldest ones appearing first, sorted by order date in ascending order
SELECT * 
FROM Orders 
ORDER BY OrderDate ASC;
-- Output
ORDERID CUSTOMERID EMPLOYEEID ORDERDATE  SHIPPERID
---------- ---------- ---------- --------- ----------
         1          1          1 15-08-24          10 
         2          2          2 16-08-24          20 
         3          3          3 17-08-24          30 
         4          4          4 18-08-24          40 
         5          5          5 19-08-24          50 

-- Find the employees who were born after 1980 and list them in descending order of their birthdates
SELECT * 
FROM Employees 
WHERE BirthDate > TO_DATE('1980-01-01', 'YYYY-MM-DD') 
ORDER BY BirthDate DESC;
-- Output
EMPLOYEEID LASTNAME                                                                                             FIRSTNAME                                                                                            BIRTHDATE PHOTO                                                                          
---------- ---------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------- --------- --------------------------------------------------------------------------------
         3 Johnson                                                                                              Robert                                                                                               30-07-90                                                                                   
         4 Brown                                                                                                Emily                                                                                                10-12-85                                                                                   
         1 Doe                                                                                                  John                                                                                                 15-01-80                                                                                   

-- List orders placed by customers from 'USA' in descending order of the order date
SELECT o.* 
FROM Orders o
JOIN Customer c ON o.CustomerID = c.CustomerID
WHERE c.Country = 'USA'
ORDER BY o.OrderDate DESC;
-- Output
ORDERID CUSTOMERID EMPLOYEEID ORDERDATE  SHIPPERID
---------- ---------- ---------- --------- ----------
         2          2          2 16-08-24          20 
         1          1          1 15-08-24          10 

-- Calculate the total number of orders placed by each customer
SELECT c.CustomerID, c.CustomerName, COUNT(o.OrderID) AS TotalOrders
FROM Customer c
LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID, c.CustomerName
ORDER BY TotalOrders DESC;
-- Output
CUSTOMERID CUSTOMERNAME                                                                                         TOTALORDERS
---------- ---------------------------------------------------------------------------------------------------- -----------
         4 Liam                                                                                                           1 
         1 John                                                                                                           1 
         3 Samantha                                                                                                       1 
         5 Emma                                                                                                           1 
         2 Jane                                                                                                           1 

-- List the cities with the total number of customers
SELECT City, COUNT(CustomerID) AS TotalCustomers
FROM Customer
GROUP BY City
ORDER BY TotalCustomers DESC;
-- Output
CITY                                                                                                 TOTALCUSTOMERS
---------------------------------------------------------------------------------------------------- --------------
Sydney                                                                                                            1 
Berlin                                                                                                            1 
Paris                                                                                                             1 
Metropolis                                                                                                        1 
Springfield                                                                                                       1 

-- List customers who have placed more than 2 orders
SELECT c.CustomerID, c.CustomerName, COUNT(o.OrderID) AS TotalOrders
FROM Customer c
JOIN Orders o ON c.CustomerID = o.CustomerID
GROUP BY c.CustomerID, c.CustomerName
HAVING COUNT(o.OrderID) > 2
ORDER BY TotalOrders DESC;
-- Output
no rows selected

-- Display cities with more than 3 customers
SELECT City, COUNT(CustomerID) AS TotalCustomers
FROM Customer
GROUP BY City
HAVING COUNT(CustomerID) > 3
ORDER BY TotalCustomers DESC;
-- Output
no rows selected
